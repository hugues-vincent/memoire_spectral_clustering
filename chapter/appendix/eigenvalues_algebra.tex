\section{Valeurs propres obtenues via algèbre linéaire}\label{annexe: A}
Dans cette annexe nous allons trouver les valeurs propres de l'\autoref{eq: A generalize}.

On a 
\begin{align*}
	\langle A \rangle = \theta_q \otimes \mathbf{1}_{n_q} \mathbf{1}_{n_q}^t
\end{align*}
avec $\theta_q$ une matrice $q \times q$, dont les éléments diagonaux sont égaux à $a$ et les autres sont égaux à $b$, $\mathbf{1}_{n_q}$ le vecteur colonne rempli de $1$ et de taille $n_q$, et $\otimes$ est le produit de Kronecker.\\
On cherche les valeurs propres de $\langle A \rangle$: 
\begin{align*}
	&\Leftrightarrow 
		|\A - \lambda I_n| = 0\\
	&\Leftrightarrow 
		det(\theta_q \otimes \mathbf{1}_{n_q} \mathbf{1}_{n_q}^t - \lambda I_n) = 0
\end{align*}
On a 
\begin{align*}
	det(\A) &= 
\begin{vmatrix}
B & C &  \dots & \dots & C \\ 
C & \ddots &  & & \vdots \\ 
\vdots &  &  & \ddots & C \\ 
C & \ldots & \ldots & C & B
\end{vmatrix} \\
\end{align*}
Où $B = a\mathbf{1}_{n_q} \mathbf{1}_{n_q}^t - \lambda I_{n_q}$ et $C = b \mathbf{1}_{n_q} \mathbf{1}_{n_q}^t$.\\

On a la formule de déterminant par blocs suivante: 
\begin{align*}
det \left(\begin{matrix} A & 0 \\ C & D \end{matrix} \right) = det(A)det(D)
\end{align*}
et en utilisant les combinaisons linaires lignes/colonnes suivantes $q-2$ fois
\begin{align}\label{eq: matrix method}
	(L_n \leftarrow L_n  - L_{n-1}) \\
	(C_{n-1} \leftarrow C_{n-1}  + C_n) \nonumber
\end{align}
on obtient
\begin{align*}
	det(\A ) &= 
	\begin{vmatrix}
	B & (q-1)C\\
	C & B + (q-2)C
	\end{vmatrix}
	| B - C |^{q-2} \\
	 &= F_{n_q}G_{n_q}^{q-2}
\end{align*}

Commençons par factoriser le polynôme $G_{n_q}^{q-2}$.
En utilisant la même stratégie que \eqref{eq: matrix method}, on obtient:
\begin{align*}
	G_{n_q} = (-\lambda)^{n_q - 1} (\lambda - n_q(a-b))
\end{align*}

Même stratégie pour $F_{n_q}$ et $H_{n_q}$ qui suit, on obtient: 
\begin{align*}
	F_{n_q} &= (-\lambda)^{n_q - 1} H_{n_{q}}\\
	H_{n_{q}} &= 
	\begin{vmatrix}
	A & n_{q}(q-1)\mathbf{1}_{n_q} \\
	b\mathbf{1}_{n_q}^t  &  n_q(a + (q-2)b) - \lambda
	\end{vmatrix}\\
	&= (-\lambda)^{n_q - 1}E_{n_q}\\
	&= (-\lambda)^{n_q - 1}(\lambda - n_q(a + (q-1)b))(\lambda - n_q(a-b)) 
\end{align*}
On a donc au final
\begin{equation}
	\boxed{det(\A - \lambda I_n) = (-\lambda)^{q(n_q -1)}(\lambda - n_q(a-b))^{q-1}(\lambda - n_q(a + (q-1)b)) }
\end{equation}
Donc les trois valeurs propres de la matrice $\A$ sont $0$, $n_q(p_{in} + (q-1)p_{out})$, $n_q(p_{in}-p_{out})$ de multiplicités respectives $q(n_q - 1)$, $1$, $q-1$.\\